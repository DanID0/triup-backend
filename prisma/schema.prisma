generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
 //url = env("DATABASE_URL")
}
enum Role {
  ADMIN
  USER
}
enum Language {
  LATVIAN
  ENGLISH
  RUSSIAN
}
enum AccessType {
  Public
  Privates
}
enum InvitedUserRights {
  Guest
  Member
  Admin
}
enum Priority {
  Low
  Medium
  High
}

model User{
id String @id @default(uuid())
username String @unique
password String
email String @unique
role Role @default(USER)
interfaceLanguage Language  @default(LATVIAN)
Workspace Workspace[]
Tasks Task[]
Comments Comment[]
hashedRefreshToken String?
UserBoard UserBoard[]
UserWorkspace UserWorkspace[]
}


model UserWorkspace { 
  id String @id @default(uuid())
  userId String @unique
  user User @relation(fields: [userId], references: [id])
  workspaceId String @unique
  workspace Workspace @relation(fields: [workspaceId], references: [id])
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Workspace {
  id String @id @default(uuid())
  userId String @unique
  user User @relation(fields: [userId], references: [id])
  name String
  accessType AccessType @default(Public)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  Boards Board[]
  UserWorkspace UserWorkspace[]
}




model Board {
id String @id @default(uuid())
workspaceId String @unique
workspace Workspace @relation(fields: [workspaceId], references: [id])
name String
UserBoard UserBoard[]
createdAt DateTime @default(now())
updatedAt DateTime @updatedAt
columns Column[]
}

model UserBoard{
  id String @id @default(uuid())
  userId String @unique
  user User @relation(fields: [userId], references: [id])
  boardId String @unique
  board Board @relation(fields: [boardId], references: [id])
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  invitedUserRights InvitedUserRights @default(Guest)
}


model Column {
  id String @id @default(uuid())
  boardId String @unique
  board Board @relation(fields: [boardId], references: [id])
  position BigInt @default(0)
  color String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  tasks Task[]
}
model Task {
  id String @id @default(uuid())
  columnId String @unique
  column Column @relation(fields: [columnId], references: [id])
  name String
  description String?
  priority Priority @default(Medium)
  dueDate DateTime?
  assigneeId String?
  assignee User? @relation(fields: [assigneeId], references: [id])
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  comments Comment[]
}

model Comment {
  id String @id @default(uuid())
  taskId String @unique
  task Task @relation(fields: [taskId], references: [id])
  userId String
  user User @relation(fields: [userId], references: [id])
  content String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}